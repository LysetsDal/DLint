module Rules.Misc.EnvWarns

open Rules.MiscWarn

// List of commonly used keys, tokens, certificates, database strings and credentials
let bad_env = [
    "accessToken"
    "access_token"
    "access_tkn"
    "accesstoken"
    "apikey"
    "api_key"
    "apiToken"
    "api_token"
    "authkey"
    "auth_key"
    "authToken"
    "auth_token"
    "authkey"
    "auth_key"
    "authtoken"
    "auth_token"
    "bearerToken"
    "bearer_token"
    "cert"
    "certificate"
    "clientid"
    "client_id"
    "clientKey"
    "client_key"
    "clientsecret"
    "client_secret"
    "creds"
    "credentials"
    "database"
    "data_base"
    "db"
    "dbApiKey"
    "db_api_key"
    "dbApiToken"
    "db_api_token"
    "dbAuth"
    "db_auth"
    "dbBearerToken"
    "db_bearer_token"
    "dbCertificate"
    "db_certificate"
    "dbClient"
    "db_client"
    "dbConnectionString"
    "db_connection_string"
    "dbCreds"
    "db_creds"
    "dbCredentials"
    "db_credentials"
    "dbEncryptionKey"
    "db_encryption_key"
    "dbKey"
    "db_key"
    "dbPass"
    "db_pass"
    "dbPassword"
    "db_password"
    "dbPasswordHash"
    "db_password_hash"
    "dbPasswordSalt"
    "db_password_salt"
    "dbSecret"
    "db_secret"
    "dbSecretKey"
    "db_secret_key"
    "dbSession"
    "db_session"
    "dbSessionID"
    "db_session_id"
    "dbSessionToken"
    "db_session_token"
    "dbToken"
    "db_token"
    "dbUri"
    "db_uri"
    "dbUrl"
    "db_url"
    "dbUser"
    "db_user"
    "dbUserToken"
    "db_user_token"
    "jwtToken"
    "jwt_token"
    "mongo"
    "mongo_db"
    "mysql"
    "oauthtoken"
    "oauth_token"
    "pass"
    "passwd"
    "password"
    "postgres"
    "secret"
    "secret_key"
    "secretKey"
    "secretkey"
    "sessionID"
    "session_id"
    "sessionToken"
    "session_token"
    "sqlite"
    "tkn"
    "token"
]


let envWarn100 : MiscWarn = {
    ErrorCode = "ENVW100"
    Problem =  ""
    ErrorMsg = "Are you passing in secrets, tokens or credentials? Don't hardcode them into the Dockerfile with the ENV instruction. Use Docker secrets or a third party password manager instead."
}